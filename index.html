<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UpBuild Documentation</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“„</text></svg>">
</head>
<body class="bg-gray-100 text-gray-900">
  <header class="w-full bg-white shadow-md sticky top-0 z-50 flex items-center justify-between px-6 py-4">
    <h1 class="text-xl font-bold">UpBuild Documentation</h1>
  </header>

  <div class="flex min-h-screen">
    <aside class="w-64 bg-white shadow-md p-6 fixed h-full overflow-y-auto">
      <h2 class="text-lg font-semibold mb-6">Navigation</h2>
      <nav class="flex flex-col gap-4">
        <a href="#overview" class="text-gray-600 hover:text-gray-900">Overview</a>
        <a href="#users" class="text-gray-600 hover:text-gray-900">Users Collection</a>
        <a href="#apartments" class="text-gray-600 hover:text-gray-900">Apartments Collection</a>
        <a href="#visitors" class="text-gray-600 hover:text-gray-900">Visitors Collection</a>
        <a href="#maintenance" class="text-gray-600 hover:text-gray-900">Maintenance Collection</a>
        <a href="#facilities" class="text-gray-600 hover:text-gray-900">Facilities Staff Collection</a>
        <a href="#complaints" class="text-gray-600 hover:text-gray-900">Complaints Collection</a>
        <a href="#userflow" class="text-gray-600 hover:text-gray-900">User Flow Story</a>
        <a href="#architecture" class="text-gray-600 hover:text-gray-900">Architecture</a>
        <a href="#routing" class="text-gray-600 hover:text-gray-900">API & Routing Structure</a>
      </nav>
    </aside>

    <main class="ml-64 p-10 flex-1 space-y-16">
      <!-- Other sections already present -->

      <section id="architecture">
        <h2 class="text-2xl font-semibold mb-4">Architecture</h2>
        <p class="text-gray-700 bg-white p-6 rounded-lg shadow">
          All users (SaaS owner, platform admins, tenant admins, staff, tenants) are stored in a single <code>users</code> collection.<br>
          Each user is differentiated by two fields:<br>
          <strong>globalRole</strong>: 'owner', 'platformAdmin', or 'tenantUser'<br>
          <strong>tenantRole</strong>: 'admin', 'staff', 'receptionist', 'guard', 'technician', 'resident' (only for tenantUsers)<br>
          Platform Admins (SaaS team) have <code>globalRole: platformAdmin</code> with no tenant linkage.<br>
          Tenant Admins, Staff, and Residents have <code>globalRole: tenantUser</code> and a linked <code>tenantId</code>.<br>
          This architecture simplifies user management, authentication, authorization, and scaling.
        </p>
      </section>

      <section id="routing">
        <h2 class="text-2xl font-semibold mb-4">Recommended API and Routing Structure</h2>
        <div class="space-y-6 text-gray-700 bg-white p-6 rounded-lg shadow">
          <h3 class="text-xl font-bold">Routes by Role:</h3>
          <ul class="list-disc pl-6">
            <li><strong>/platform-admin/*</strong>: Accessed by users with <code>globalRole: owner</code> or <code>platformAdmin</code>. Manages tenants, platform settings.</li>
            <li><strong>/tenant-admin/*</strong>: Accessed by users with <code>globalRole: tenantUser</code> and <code>tenantRole: admin</code>. Manages their own apartment complex operations.</li>
            <li><strong>/staff/*</strong>: Accessed by users with <code>globalRole: tenantUser</code> and <code>tenantRole: receptionist/guard/technician</code>. Handles daily staff tasks.</li>
            <li><strong>/tenant/*</strong>: Accessed by users with <code>globalRole: tenantUser</code> and <code>tenantRole: resident</code>. Used by normal residents to interact with the system.</li>
          </ul>

          <h3 class="text-xl font-bold">Access Control:</h3>
          <ul class="list-disc pl-6">
            <li>Middleware checks <code>globalRole</code> and <code>tenantRole</code> after authentication token decoding.</li>
            <li>APIs are protected based on allowed roles and tenantId verification.</li>
            <li>Platform-level APIs are separated from tenant-level APIs securely.</li>
          </ul>
        </div>
      </section>

    </main>
  </div>
</body>
</html>
